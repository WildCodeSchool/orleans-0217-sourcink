{% extends "@FOSUser/layout.html.twig" %}

{% block fos_user_content %}
{% include "@FOSUser/Registration/register_content.html.twig" %}
{% endblock fos_user_content %}
{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
        $('#send').on('click',function(e){
            event.preventDefault();
            var resume = $('#resume').val();
            var formData = new FormData();
            formData.append('resume', $('input[type=file]')[0].files[0]);
            $.ajax({
                url: '/ajax/resume/parse',
                type: 'POST',
                dataType: 'json',
                data: formData,
                processData: false,
                contentType: false,
                success: function(response){
                    var resume = JSON.parse(response.data);
                    $('#fos_user_registration_form_firstname').val(resume.first_name);
                    $('#fos_user_registration_form_lastname').val(resume.last_name);
                    $('#fos_user_registration_form_email').val(resume.emails.primary);
                },
                error: function() {
                }
            });
//            $.post( '/ajax/resume/parse', {'data':fd}).done(function(response) {
//            });
        });
    </script>
{% endblock %}
